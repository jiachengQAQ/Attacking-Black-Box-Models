# Data-Free Model Extraction and Transfer Attacks

This repository provides the implementation for **Data-Free Model Extraction (DFME)** and **Data-Free Transfer Attacks (DFTA)** on CIFAR-10 and CIFAR-100. Synthetic data are generated using Stable Diffusion Models (SDMs), without requiring access to the target model's training data.

> **Note:** Due to upload size limitations, pretrained models and generated synthetic images are not included. Please follow the instructions below to reproduce the full pipeline locally.

---

### Step 1: Generate Synthetic Data

Since the synthetic data used for querying are generated by SDMs and are subject to file size limitations, you will need to generate them locally.

Run the following script to generate synthetic images for **CIFAR-10** and **CIFAR-100**:

```bash
python generation_syn_data.py
```



### Step 2: Train Target and Substitute Models

Since the target model needs to be trained on a real dataset, you can run train.py to train it and then save the checkpoint. Afterwards, use the synthetic data generated in Step 1 to similarly train the substitute model by running train.py.

### Step 3: Run DFME and DFTA Tasks

Select subsets from the synthetic data generated in Step 1 (e.g., 5k samples) and run the following code to train for the DFME (Data-Free Model Extraction) and DFTA (Data-Free Transfer Attack) tasks.

Run DFME task on CIFAR-10 for soft-label:
```bash
python train_clone.py --data_type=cifar10 --query_number=5000 --loss=l1 --only_dfme=True
```
Run DFME task on CIFAR-10 for hard-label:
```bash
python train_clone.py --data_type=cifar10 --query_number=5000 --loss=ce --only_dfme=True
```
